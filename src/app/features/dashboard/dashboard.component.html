<div class="p-4">
  
  <div class="flex justify-content-between align-items-center mb-4">
    <h1 class="text-900 m-0 text-3xl font-bold">Tableau de Bord</h1>
    <div class="text-500 text-sm">Vue d'ensemble de la campagne</div>
  </div>

  <!-- SKELETON LOADING -->
  <div *ngIf="isLoading()" class="grid">
    <div class="col-12 md:col-6 lg:col-3" *ngFor="let i of [1,2,3,4]">
      <p-skeleton height="8rem" borderRadius="12px"></p-skeleton>
    </div>
  </div>

  <!-- KPI CARDS -->
  <div *ngIf="!isLoading()" class="grid">
    
    <!-- 1. Total Visites Globales -->
    <div class="col-12 md:col-6 lg:col-3">
      <div class="card shadow-1 p-3 border-round-xl bg-white border-left-3 border-blue-500 h-full">
        <div class="flex justify-content-between mb-3">
          <div>
            <span class="block text-500 font-medium mb-2 uppercase text-xs tracking-wide">Visites Globales</span>
            <div class="text-900 font-bold text-3xl">{{ totalVisits() | number }}</div>
          </div>
          <div class="flex align-items-center justify-content-center bg-blue-50 border-round" style="width:3rem;height:3rem">
            <i class="pi pi-globe text-blue-500 text-xl"></i>
          </div>
        </div>
        <span class="text-500 text-sm">Cumul total - Site Web</span>
      </div>
    </div>

    <!-- 2. Challenge Actif -->
    <div class="col-12 md:col-6 lg:col-3">
      <div class="card shadow-1 p-3 border-round-xl bg-white border-left-3 border-green-500 h-full">
        <div class="flex justify-content-between mb-3">
          <div>
            <span class="block text-500 font-medium mb-2 uppercase text-xs tracking-wide">Challenge Actif</span>
            <div class="text-900 font-bold text-3xl">
              {{ activeChallenge()?.currentViews || 0 | number }}
            </div>
          </div>
          <div class="flex align-items-center justify-content-center bg-green-50 border-round" style="width:3rem;height:3rem">
            <i class="pi pi-bolt text-green-500 text-xl"></i>
          </div>
        </div>
        <span class="text-500 text-sm" *ngIf="activeChallenge()">
          Objectif: {{ activeChallenge()?.targetViews | number }}
        </span>
      </div>
    </div>

    <!-- 3. TikTok Stats -->
    <div class="col-12 md:col-6 lg:col-3">
      <div class="card shadow-1 p-3 border-round-xl bg-white border-left-3 border-gray-900 h-full">
        <div class="flex justify-content-between mb-3">
          <div>
            <span class="block text-500 font-medium mb-2 uppercase text-xs tracking-wide">Impact TikTok</span>
            <div class="text-900 font-bold text-3xl">{{ totalTiktokUsage() | number }}</div>
          </div>
          <div class="flex align-items-center justify-content-center bg-gray-100 border-round" style="width:3rem;height:3rem">
            <i class="pi pi-tiktok text-gray-900 text-xl"></i>
          </div>
        </div>
        <span class="text-500">{{ tiktokFilters().length }}</span>
        <span class="text-500"> filtres actifs</span>
      </div>
    </div>

    <!-- 4. Snapchat Stats -->
    <div class="col-12 md:col-6 lg:col-3">
      <div class="card shadow-1 p-3 border-round-xl bg-white border-left-3 border-yellow-300 h-full">
        <div class="flex justify-content-between mb-3">
          <div>
            <span class="block text-500 font-medium mb-2 uppercase text-xs tracking-wide">Impact Snapchat</span>
            <div class="text-900 font-bold text-3xl">{{ totalSnapUsage() | number }}</div>
          </div>
          <div class="flex align-items-center justify-content-center bg-yellow-50 border-round" style="width:3rem;height:3rem">
            <i class="pi pi-camera text-yellow-400 text-xl"></i>
          </div>
        </div>
        <span class="text-500 font-medium">{{ snapchatFilters().length }}</span>
        <span class="text-500"> filtres actifs</span>
      </div>
    </div>
  </div>

  <!-- CHARTS -->
  <div class="grid mt-4" *ngIf="!isLoading()">
    
    <!-- Bar Chart -->
    <div class="col-12 lg:col-8">
      <div class="card shadow-1 p-4 border-round-xl bg-white h-full">
        <div class="flex justify-content-between align-items-center mb-4">
          <h3 class="m-0 text-lg text-900">Top Challenges</h3>
          <p-tag value="Par Vues" severity="info"></p-tag>
        </div>
        <p-chart type="bar" [data]="chartData" [options]="chartOptions" height="300px"></p-chart>
      </div>
    </div>
    
    <!-- Doughnut Chart -->
    <div class="col-12 lg:col-4">
      <div class="card shadow-1 p-4 border-round-xl bg-white h-full flex flex-column">
        <h3 class="mt-0 mb-4 text-lg text-900">RÃ©partition Sociale</h3>
        <div class="flex-1 flex align-items-center justify-content-center">
          <p-chart type="doughnut" [data]="pieData" height="250px"></p-chart>
        </div>
        <div class="text-center mt-3 text-500 text-sm">
          Comparaison de l'utilisation des filtres
        </div>
      </div>
    </div>

  </div>
</div>